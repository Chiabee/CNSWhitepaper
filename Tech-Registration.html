<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Registration - Chia Name Service White Paper</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="Cover.html"><strong aria-hidden="true">1.</strong> Cover</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="Introduction.html"><strong aria-hidden="true">2.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="Design.html"><strong aria-hidden="true">3.</strong> Design</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Lifecycle.html"><strong aria-hidden="true">3.1.</strong> Lifecycle</a></li><li class="chapter-item expanded "><a href="Policy.html"><strong aria-hidden="true">3.2.</strong> Policy</a></li></ol></li><li class="chapter-item expanded "><a href="Architecture.html"><strong aria-hidden="true">4.</strong> Technical Architecture</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Tech-Registration.html" class="active"><strong aria-hidden="true">4.1.</strong> Registration</a></li><li class="chapter-item expanded "><a href="Tech-Resolution.html"><strong aria-hidden="true">4.2.</strong> Resolution</a></li><li class="chapter-item expanded "><a href="Tech-Management.html"><strong aria-hidden="true">4.3.</strong> Management</a></li><li class="chapter-item expanded "><a href="Tech-Renewing.html"><strong aria-hidden="true">4.4.</strong> Renewing</a></li><li class="chapter-item expanded "><a href="Tech-Subdomain.html"><strong aria-hidden="true">4.5.</strong> Subdomain</a></li></ol></li><li class="chapter-item expanded "><a href="Guide.html"><strong aria-hidden="true">5.</strong> Guide</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Guide-Registration.html"><strong aria-hidden="true">5.1.</strong> Registration</a></li></ol></li><li class="chapter-item expanded "><a href="Security.html"><strong aria-hidden="true">6.</strong> Security</a></li><li class="chapter-item expanded "><a href="Governance.html"><strong aria-hidden="true">7.</strong> Governance</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Pricing.html"><strong aria-hidden="true">7.1.</strong> Pricing</a></li><li class="chapter-item expanded "><a href="Airdrop.html"><strong aria-hidden="true">7.2.</strong> Airdrop</a></li></ol></li><li class="chapter-item expanded "><a href="Beyond.html"><strong aria-hidden="true">8.</strong> Beyond</a></li><li class="chapter-item expanded "><a href="API/index.html"><strong aria-hidden="true">9.</strong> API</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="API/Resolve.html"><strong aria-hidden="true">9.1.</strong> Resolve</a></li><li class="chapter-item expanded "><a href="API/Verify.html"><strong aria-hidden="true">9.2.</strong> Verify</a></li><li class="chapter-item expanded "><a href="API/Register.html"><strong aria-hidden="true">9.3.</strong> Register</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="Faq.html"><strong aria-hidden="true">10.</strong> FAQ</a></li><li class="chapter-item expanded "><a href="About.html"><strong aria-hidden="true">11.</strong> About Us</a></li><li class="chapter-item expanded "><a href="BackCover.html"><strong aria-hidden="true">12.</strong> Back Cover</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Chia Name Service White Paper</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="registration"><a class="header" href="#registration">Registration</a></h1>
<p><img src="registration.svg" alt="" /></p>
<p>If you ever try to inspect the registration offer, you will find this offer is special, the trading NFT is not created yet, and will only be created when the offer is successfully accepted.</p>
<p>Beside this, what is the difference between the CNS and the standard NFT?</p>
<ol>
<li>metadata updater changed</li>
</ol>
<pre><code class="language-diff">  - `singleton_top_layer_v1_1`
    - `SINGLETON_STRUCT`: ...
    - `INNER_PUZZLE`: `nft_state_layer`
      - `NFT_STATE_LAYER_MOD_HASH`: 0xa0a04d9f57764f54a43e4030befb4d80026e870519aaa66334aef8304f5d0393c2
      - `METADATA`: ...
-     - `METADATA_UPDATER_PUZZLE_HASH`: 0xa0fe8a4b4e27a2e29a4d3fc7ce9d527adbcaccbab6ada3903ccf3ba9a769d2d78b
+     - `METADATA_UPDATER_PUZZLE_HASH`: 0xa020ea3991407203334e6a705517f4cba83f7987353d883f0938633ce7e1740fad
      - `INNER_PUZZLE`: `nft_ownership_layer`
        - `NFT_OWNERSHIP_LAYER_MOD_HASH`: 0xa0c5abea79afaa001b5427dfa0c8cf42ca6f38f5841b78f9b3c252733eb2de2726
        - `CURRENT_OWNER`: 0x80
        - `TRANSFER_PROGRAM`: `nft_ownership_transfer_program_one_way_claim_with_royalties`
          - `SINGLETON_STRUCT`: ...
          - `ROYALTY_ADDRESS`: ...
          - `TRADE_PRICE_PERCENTAGE`: ...
        - `INNER_PUZZLE`: `p2_delegated_puzzle_or_hidden_puzzle`
          - `synthetic_public_key`: ...
</code></pre>
<p>the metadata updater can be found <a href="https://github.com/SutuLabs/Pawket/blob/master/packages/cli/clvm/nft_metadata_updater_cns.clvm">here</a>, while the official metadata updater can be found <a href="https://github.com/Chia-Network/chia-blockchain/blob/main/chia/wallet/nft_wallet/puzzles/nft_metadata_updater_default.clsp">here</a>, main changes is allow changes of custom binding information in the CNS NFT.</p>
<ol start="2">
<li>metadata changed</li>
</ol>
<p>If you find any random CNS, and look into the metadata, you will find the extension fields.</p>
<pre><code class="language-diff">  (
    (117 &quot;https://storage.pawket.app/ipfs/QmS7wLEbCy1ppi3mTQCzYYNb7ZWJSP2kxtgrFH35sjfQy6?filename=helloworld.xch.jpg&quot;) 
    (104 . 0xe2fb68894b5dc73b656815a2cc5397eae737de9abe5b8015c296a282143bee93) 
    (28021 &quot;https://storage.pawket.app/ipfs/QmNfDdWVAChsrds7oMmciaDrbDmu7B2S9t1w2Ax2K7GawM?filename=helloworld.xchmetadata.json&quot;) 
    (28008 . 0x2598205f6f12e1ef872dbdc1abd7fff173167177a3f6d9ff782946e9bdf2206e) 
    (27765) 
    (27752) 
    (29550 . 1) 
    (29556 . 1) 
+   (25976 . 0x67b5ef1c) 
+   (28269 . &quot;helloworld.xch&quot;) 
+   (25188))
</code></pre>
<p>refer to following code from Pawket for its definition (and also you can find the definition in the updater chialisp code).</p>
<pre><code class="language-yaml">imageUri: getHex(&quot;u&quot;),
imageHash: getHex(&quot;h&quot;),
metadataUri: getHex(&quot;mu&quot;),
metadataHash: getHex(&quot;mh&quot;),
licenseUri: getHex(&quot;lu&quot;),
licenseHash: getHex(&quot;lh&quot;),
serialNumber: getHex(&quot;sn&quot;),
serialTotal: getHex(&quot;st&quot;),

# CNS mandatory fields
expiry: getHex(&quot;ex&quot;),
name: getHex(&quot;nm&quot;),
bindings: getHex(&quot;bd&quot;),

# CNS optional fields
address: getHex(&quot;ad&quot;),
did: getHex(&quot;id&quot;),
publicKey: getHex(&quot;pk&quot;),
text: getHex(&quot;tt&quot;),
</code></pre>
<h2 id="rationale"><a class="header" href="#rationale">Rationale</a></h2>
<h3 id="did"><a class="header" href="#did">DID</a></h3>
<p>All CNS is created by address directly with DID, this design is for parallelization. DID is not parallel-friendly, so CNS is created by the address which hold the CNS issuing private key.</p>
<p>Also, in the future, to make CNS more decentralized, the single private key will be replaced by a group of threshold signatures.</p>
<h2 id="conclusion"><a class="header" href="#conclusion">Conclusion</a></h2>
<p>With such minor changes to NFT, CNS keeps the best compatibility with the whole chia ecosystem.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="Architecture.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="Tech-Resolution.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="Architecture.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="Tech-Resolution.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="mermaid.min.js"></script>
        <script type="text/javascript" src="mermaid-init.js"></script>
    </body>
</html>
